(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cf0849d"],{"3c14":function(e,t,i){},"8c10":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"page-container"},[i("div",{staticClass:"toolbar"},[i("el-form",{attrs:{inline:!0,model:e.filters}},[i("el-form-item",[i("el-input",{attrs:{placeholder:"用户名"},model:{value:e.filters.userName,callback:function(t){e.$set(e.filters,"userName",t)},expression:"filters.userName"}})],1),i("el-form-item",[i("el-input",{attrs:{placeholder:"标题"},model:{value:e.filters.title,callback:function(t){e.$set(e.filters,"title",t)},expression:"filters.title"}})],1),i("el-form-item",[i("el-select",{attrs:{clearable:"",placeholder:"是否推荐"},model:{value:e.filters.recommend,callback:function(t){e.$set(e.filters,"recommend",t)},expression:"filters.recommend"}},[i("el-option",{attrs:{label:"推荐",value:"1"}}),i("el-option",{attrs:{label:"未推荐",value:"0"}})],1)],1),i("el-form-item",[i("el-select",{attrs:{clearable:"",placeholder:"是否置顶"},model:{value:e.filters.sticky,callback:function(t){e.$set(e.filters,"sticky",t)},expression:"filters.sticky"}},[i("el-option",{attrs:{label:"是",value:"1"}}),i("el-option",{attrs:{label:"否",value:"0"}})],1)],1),i("el-form-item",[i("el-select",{attrs:{clearable:"",placeholder:"请选择状态"},model:{value:e.filters.status,callback:function(t){e.$set(e.filters,"status",t)},expression:"filters.status"}},[i("el-option",{attrs:{label:"正常",value:"0"}}),i("el-option",{attrs:{label:"删除",value:"1"}})],1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.list}},[e._v(" 查询 ")])],1)],1)],1),i("div",{staticClass:"page-section topics"},e._l(e.results,(function(t){return i("div",{key:t.id,staticClass:"topic-item"},[i("div",{staticClass:"topic-avatar"},[i("avatar",{attrs:{user:t.user}})],1),i("div",{staticClass:"topic-main"},[i("div",{staticClass:"topic-header"},[i("a",{staticClass:"topic-nickname",attrs:{href:e._f("siteUrl")("/user/"+t.user.id),target:"_blank"}},[e._v(e._s(t.user.nickname))]),i("div",{staticClass:"topic-info"},[1===t.status?i("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v("已删除")]):e._e(),t.recommend?i("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v("已推荐")]):e._e(),t.sticky?i("span",{staticClass:"topic-sticky-icon"},[e._v("置顶")]):e._e()])]),i("div",{staticClass:"topic-metadata"},[i("span",{staticClass:"topic-metadata-item"},[e._v("ID: "+e._s(t.id))]),i("span",{staticClass:"topic-metadata-item"},[e._v("发布于："+e._s(e._f("formatDate")(t.createTime)))]),i("span",{staticClass:"node topic-metadata-item"},[e._v(e._s(t.node?t.node.name:""))]),i("span",{staticClass:"topic-metadata-item"},e._l(t.tags,(function(t){return i("el-tag",{key:t.id,staticStyle:{"margin-right":"12px"},attrs:{type:"info",size:"mini"}},[e._v(" #"+e._s(t.name)+" ")])})),1)]),i("div",{staticClass:"topic-title"},[i("a",{attrs:{href:e._f("siteUrl")("/topic/"+t.id),target:"_blank"}},[e._v(e._s(t.title))])]),i("div",{staticClass:"topic-summary"},[e._v(" "+e._s(t.summary)+" ")]),t.imageList&&t.imageList.length?i("ul",{staticClass:"topic-image-list"},e._l(t.imageList,(function(a,s){return i("li",{key:s},[i("a",{staticClass:"image-item",attrs:{href:e._f("siteUrl")("/topic/"+t.id),target:"_blank"}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.preview,expression:"image.preview"}]})])])})),0):e._e(),i("div",{staticClass:"topic-actions"},[0===t.status?i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.deleteSubmit(t.id)}}},[e._v("删除")]):i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.undeleteSubmit(t.id)}}},[e._v("取消删除")]),t.recommend?i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.cancelRecommend(t.id)}}},[e._v("取消推荐")]):i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.recommend(t.id)}}},[e._v("推荐")]),t.sticky?i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.cancelSticky(t.id)}}},[e._v("取消置顶")]):i("el-button",{staticClass:"action-item btn",attrs:{type:"text"},on:{click:function(i){return e.sticky(t.id)}}},[e._v("置顶")])],1)])])})),0),i("div",{staticClass:"pagebar"},[i("el-pagination",{attrs:{"page-sizes":[20,50,100,300],"current-page":e.page.page,"page-size":e.page.limit,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handlePageChange,"size-change":e.handleLimitChange}})],1),i("el-dialog",{attrs:{visible:e.addFormVisible,"close-on-click-modal":!1,title:"新增"},on:{"update:visible":function(t){e.addFormVisible=t}}},[i("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"userId",prop:"rule"}},[i("el-input",{model:{value:e.addForm.userId,callback:function(t){e.$set(e.addForm,"userId",t)},expression:"addForm.userId"}})],1),i("el-form-item",{attrs:{label:"title",prop:"rule"}},[i("el-input",{model:{value:e.addForm.title,callback:function(t){e.$set(e.addForm,"title",t)},expression:"addForm.title"}})],1),i("el-form-item",{attrs:{label:"content",prop:"rule"}},[i("el-input",{model:{value:e.addForm.content,callback:function(t){e.$set(e.addForm,"content",t)},expression:"addForm.content"}})],1),i("el-form-item",{attrs:{label:"status",prop:"rule"}},[i("el-input",{model:{value:e.addForm.status,callback:function(t){e.$set(e.addForm,"status",t)},expression:"addForm.status"}})],1),i("el-form-item",{attrs:{label:"createTime",prop:"rule"}},[i("el-input",{model:{value:e.addForm.createTime,callback:function(t){e.$set(e.addForm,"createTime",t)},expression:"addForm.createTime"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v(" 取消 ")]),i("el-button",{attrs:{loading:e.addLoading,type:"primary"},nativeOn:{click:function(t){return e.addSubmit.apply(null,arguments)}}},[e._v(" 提交 ")])],1)],1),i("el-dialog",{attrs:{visible:e.editFormVisible,"close-on-click-modal":!1,title:"编辑"},on:{"update:visible":function(t){e.editFormVisible=t}}},[i("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editFormRules,"label-width":"80px"}},[i("el-input",{attrs:{type:"hidden"},model:{value:e.editForm.id,callback:function(t){e.$set(e.editForm,"id",t)},expression:"editForm.id"}}),i("el-form-item",{attrs:{label:"forumId",prop:"rule"}},[i("el-input",{model:{value:e.editForm.forumId,callback:function(t){e.$set(e.editForm,"forumId",t)},expression:"editForm.forumId"}})],1),i("el-form-item",{attrs:{label:"userId",prop:"rule"}},[i("el-input",{model:{value:e.editForm.userId,callback:function(t){e.$set(e.editForm,"userId",t)},expression:"editForm.userId"}})],1),i("el-form-item",{attrs:{label:"title",prop:"rule"}},[i("el-input",{model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),i("el-form-item",{attrs:{label:"content",prop:"rule"}},[i("el-input",{model:{value:e.editForm.content,callback:function(t){e.$set(e.editForm,"content",t)},expression:"editForm.content"}})],1),i("el-form-item",{attrs:{label:"status",prop:"rule"}},[i("el-input",{model:{value:e.editForm.status,callback:function(t){e.$set(e.editForm,"status",t)},expression:"editForm.status"}})],1),i("el-form-item",{attrs:{label:"createTime",prop:"rule"}},[i("el-input",{model:{value:e.editForm.createTime,callback:function(t){e.$set(e.editForm,"createTime",t)},expression:"editForm.createTime"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.editFormVisible=!1}}},[e._v(" 取消 ")]),i("el-button",{attrs:{loading:e.editLoading,type:"primary"},nativeOn:{click:function(t){return e.editSubmit.apply(null,arguments)}}},[e._v(" 提交 ")])],1)],1)],1)},s=[],r=i("1da1"),n=(i("96cf"),i("d3b7"),i("df3a")),o={components:{Avatar:n["a"]},data:function(){return{results:[],listLoading:!1,page:{},filters:{},selectedRows:[],addForm:{forumId:"",userId:"",title:"",content:"",status:"",createTime:""},addFormVisible:!1,addFormRules:{},addLoading:!1,editForm:{id:"",forumId:"",userId:"",title:"",content:"",status:"",createTime:""},editFormVisible:!1,editFormRules:{},editLoading:!1}},mounted:function(){this.list()},methods:{list:function(){var e=this;e.listLoading=!0;var t=Object.assign(e.filters,{skipCount:this.getSkipCount(e.page.page,e.page.limit),maxResultCount:e.page.limit});this.axios.post("/api/app/topic/paged",t).then((function(t){e.results=t.items,e.page.total=t.totalCount})).finally((function(){e.listLoading=!1}))},handlePageChange:function(e){this.page.page=e,this.list()},handleLimitChange:function(e){this.page.limit=e,this.list()},handleAdd:function(){this.addForm={name:"",description:""},this.addFormVisible=!0},addSubmit:function(){var e=this;this.axios.form("/api/admin/topic/create",this.addForm).then((function(t){e.$message({message:"提交成功",type:"success"}),e.addFormVisible=!1,e.list()})).catch((function(t){e.$notify.error({title:"错误",message:t.message})}))},handleEdit:function(e,t){var i=this;this.axios.get("/api/admin/topic/".concat(t.id)).then((function(e){i.editForm=Object.assign({},e),i.editFormVisible=!0})).catch((function(e){i.$notify.error({title:"错误",message:e.message})}))},editSubmit:function(){var e=this;this.axios.form("/api/admin/topic/update",e.editForm).then((function(t){e.list(),e.editFormVisible=!1})).catch((function(t){e.$notify.error({title:"错误",message:t.message})}))},deleteSubmit:function(e){var t=this;this.$confirm("是否确认删除该话题?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.axios.post("/api/app/topic/"+e+"/set-delete?status=1").then((function(){t.$message({message:"删除成功",type:"success"}),t.list()})).catch((function(e){t.$notify.error({title:"错误",message:e.message||e})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},undeleteSubmit:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.axios.post("/api/app/topic/"+e+"/set-delete?status=0");case 3:t.list(),t.$message({message:"取消删除成功",type:"success"}),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),t.$notify.error({title:"错误",message:i.t0.message||i.t0});case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},recommend:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.axios.post("/api/app/topic/"+e+"/set-recommend?recommend=true");case 3:t.$message({message:"推荐成功",type:"success"}),t.list(),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),t.$notify.error({title:"错误",message:i.t0.message});case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},cancelRecommend:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.axios.post("/api/app/topic/"+e+"/set-recommend?recommend=false");case 3:t.$message({message:"取消推荐成功",type:"success"}),t.list(),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),t.$notify.error({title:"错误",message:i.t0.message});case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},sticky:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.axios.post("/api/app/topic/sticky/"+e+"?sticky=true");case 3:t.$message({message:"置顶成功",type:"success"}),t.list(),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),t.$notify.error({title:"错误",message:i.t0.message});case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},cancelSticky:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,t.axios.post("/api/app/topic/sticky/"+e+"?sticky=false");case 3:t.$message({message:"取消置顶成功",type:"success"}),t.list(),i.next=10;break;case 7:i.prev=7,i.t0=i["catch"](0),t.$notify.error({title:"错误",message:i.t0.message});case 10:case"end":return i.stop()}}),i,null,[[0,7]])})))()},handleSelectionChange:function(e){this.selectedRows=e}}},l=o,c=(i("d735"),i("2877")),m=Object(c["a"])(l,a,s,!1,null,"70af87ee",null);t["default"]=m.exports},d735:function(e,t,i){"use strict";i("3c14")}}]);
//# sourceMappingURL=chunk-5cf0849d.6c814f17.js.map
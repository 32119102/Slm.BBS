(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e14ad15"],{"0726":function(t,e,a){},"7da1":function(t,e,a){"use strict";a("0726")},d97d:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticClass:"page-container"},[a("div",{staticClass:"toolbar"},[a("el-form",{attrs:{inline:!0,model:t.filters}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"用户名"},model:{value:t.filters.userName,callback:function(e){t.$set(t.filters,"userName",e)},expression:"filters.userName"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"标题"},model:{value:t.filters.title,callback:function(e){t.$set(t.filters,"title",e)},expression:"filters.title"}})],1),a("el-form-item",[a("el-select",{attrs:{clearable:"",placeholder:"请选择状态"},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},[a("el-option",{attrs:{label:"正常",value:"0"}}),a("el-option",{attrs:{label:"删除",value:"1"}}),a("el-option",{attrs:{label:"待审核",value:"2"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.list}},[t._v(" 查询 ")])],1)],1)],1),t.results&&t.results.length>0?a("div",{staticClass:"page-section articles"},t._l(t.results,(function(e){return a("div",{key:e.id,staticClass:"article"},[a("div",{staticClass:"article-header"},[a("avatar",{attrs:{user:e.user}}),a("div",{staticClass:"article-right"},[a("div",{staticClass:"article-title"},[a("a",{attrs:{href:t._f("siteUrl")("/article/"+e.id),target:"_blank"}},[t._v(t._s(e.title))])]),a("div",{staticClass:"article-meta"},[a("label",{staticClass:"action-item info"},[t._v("ID: "+t._s(e.id))]),e.user?a("label",{staticClass:"author"},[t._v(t._s(e.user.nickname))]):t._e(),a("label",[t._v(t._s(t._f("formatDate")(e.createTime)))]),a("div",{staticClass:"article-tags"},t._l(e.tags,(function(e){return a("el-tag",{key:e.id,attrs:{type:"info",size:"mini"}},[t._v(" #"+t._s(e.name)+" ")])})),1)])])],1),a("div",{staticClass:"summary"},[t._v(" "+t._s(e.summary)+" ")]),a("div",{staticClass:"actions"},[a("a",{staticClass:"action-item btn",on:{click:function(a){return t.showUpdateTags(e)}}},[t._v("修改标签")]),1===e.status?a("span",{staticClass:"action-item danger"},[t._v("已删除")]):t._e(),1!==e.status?a("a",{staticClass:"action-item btn",on:{click:function(a){return t.deleteSubmit(e)}}},[t._v("删除")]):t._e(),2===e.status?a("a",{staticClass:"action-item btn",on:{click:function(a){return t.pendingSubmit(e)}}},[t._v("审核")]):t._e()])])})),0):a("div",{staticClass:"page-section articles"},[t._m(0)]),t.page.total>0?a("div",{staticClass:"pagebar"},[a("el-pagination",{attrs:{"page-sizes":[20,50,100,300],"current-page":t.page.page,"page-size":t.page.limit,total:t.page.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":t.handlePageChange,"size-change":t.handleLimitChange}})],1):t._e(),a("el-dialog",{attrs:{visible:t.updateTagsDialogVisible,"close-on-click-modal":!1,title:"添加标签"},on:{"update:visible":function(e){t.updateTagsDialogVisible=e}}},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"标签"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",placeholder:"标签"},model:{value:t.updateTagForm.tags,callback:function(e){t.$set(t.updateTagForm,"tags",e)},expression:"updateTagForm.tags"}},t._l(t.tags,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.updateTagsDialogVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.updateTags.apply(null,arguments)}}},[t._v(" 提交 ")])],1)],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"notification is-primary"},[a("strong",[t._v("无数据")])])}],n=a("1da1"),r=(a("a15b"),a("159b"),a("96cf"),a("df3a")),l={components:{Avatar:r["a"]},data:function(){return{results:[],listLoading:!1,page:{},filters:{},tagOptions:[],tags:[],updateTagsDialogVisible:!1,updateTagForm:{articleId:0,tags:[]}}},mounted:function(){this.getTags(),this.list()},methods:{list:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,t.listLoading=!0,s=Object.assign(t.filters,{skipCount:t.getSkipCount(a.page.page,a.page.limit),maxResultCount:a.page.limit}),e.prev=3,e.next=6,t.axios.post("/api/app/article/paged",s);case 6:i=e.sent,t.results=i.items,t.page.total=i.totalCount,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$message.error(e.t0.message);case 14:return e.prev=14,t.listLoading=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})))()},recent:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.listLoading=!0,e.prev=1,e.next=4,t.axios.get("/api/admin/article/recent");case 4:t.results=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),t.$message.error(e.t0.message);case 10:return e.prev=10,t.listLoading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})))()},getTags:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t,t.axios.get("/api/app/tag?SkipCount=0&MaxResultCount=100").then((function(t){a.tags=t.items}));case 2:case"end":return e.stop()}}),e)})))()},handlePageChange:function(t){this.page.page=t,this.list()},handleLimitChange:function(t){this.page.limit=t,this.list()},deleteSubmit:function(t){var e=this,a=this;this.$confirm("确认要删除文章？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.axios.delete("/api/app/article/"+t.id).then((function(t){a.$message({message:"删除成功",type:"success"}),a.list()})).catch((function(t){a.$notify.error({title:"错误",message:t.message})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},pendingSubmit:function(t){var e=this,a=this;this.$confirm("确认要过审文章？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.axios.post("/api/app/article/"+t.id+"/pending").then((function(t){a.$message({message:"审核成功",type:"success"}),a.list()})).catch((function(t){a.$notify.error({title:"错误",message:t.message})}))})).catch((function(){e.$message({type:"info",message:"已取消审核"})}))},showUpdateTags:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=[],a.prev=1,a.next=4,e.axios.get("/api/app/article/"+t.id+"/tags");case 4:if(i=a.sent,i&&i.length)for(n=0;n<i.length;n++)s.push(i[n].tagId);a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](1),e.$message({type:"error",message:a.t0.message||a.t0});case 11:e.$set(e.updateTagForm,"articleId",t.id),e.$set(e.updateTagForm,"tags",s),e.updateTagsDialogVisible=!0;case 14:case"end":return a.stop()}}),a,null,[[1,8]])})))()},updateTags:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.put("/api/app/article/"+t.updateTagForm.articleId+"/tags",{tagIds:(t.updateTagForm.tags||[]).join(",")});case 3:if(a=e.sent,t.results&&t.results.length)for(s=0;s<t.results.length;s++)t.results[s].id===t.updateTagForm.articleId&&(i=[],a.forEach((function(t){i.push(t.tag)})),t.results[s].tags=i);t.updateTagsDialogVisible=!1,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$message({type:"error",message:e.t0.message||e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}},c=l,o=(a("7da1"),a("2877")),u=Object(o["a"])(c,s,i,!1,null,"f046e9e0",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-5e14ad15.a1565950.js.map
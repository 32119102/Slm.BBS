(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-161b208a"],{3651:function(t,e,i){t.exports=i.p+"img/net.1e01d6d9.png"},"4ce9":function(t,e,i){"use strict";i("ce4a")},"792d":function(t,e,i){},"8f85":function(t,e,i){"use strict";i("792d")},ce4a:function(t,e,i){},d11b:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"page-container"},[a("div",{staticClass:"toolbar"},[a("el-form",{attrs:{inline:!0,model:t.filters}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"标题"},model:{value:t.filters.title,callback:function(e){t.$set(t.filters,"title",e)},expression:"filters.title"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"链接"},model:{value:t.filters.url,callback:function(e){t.$set(t.filters,"url",e)},expression:"filters.url"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.list}},[t._v(" 查询 ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v(" 新增 ")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.results,"highlight-current-row":"",stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"编号",width:"100"}}),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),a("el-table-column",{attrs:{prop:"url",label:"链接",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:e.row.url,target:"_blank"}},[t._v(t._s(e.row.url))])]}}])}),a("el-table-column",{attrs:{prop:"logo",label:"图标",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[t.row.logo?a("img",{staticClass:"link-logo",attrs:{src:t.row.logo}}):a("img",{staticClass:"link-logo",attrs:{src:i("3651")}})]}}])}),a("el-table-column",{attrs:{prop:"summary",label:"描述"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(0===e.row.status?"正常":"禁用")+" ")]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("formatDate")(e.row.createTime))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(i){return t.handleEdit(e.$index,e.row)}}},[t._v(" 编辑 ")]),a("el-button",{attrs:{size:"small"},on:{click:function(i){return t.handleDel(e.$index,e.row)}}},[t._v(" 删除 ")])]}}])})],1),a("div",{staticClass:"pagebar"},[a("el-pagination",{attrs:{"page-sizes":[20,50,100,300],"current-page":t.page.page,"page-size":t.page.limit,total:t.page.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":t.handlePageChange,"size-change":t.handleLimitChange}})],1),a("el-dialog",{attrs:{visible:t.addFormVisible,"close-on-click-modal":!1,title:"新增"},on:{"update:visible":function(e){t.addFormVisible=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"链接"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:t.addForm.url,callback:function(e){t.$set(t.addForm,"url",e)},expression:"addForm.url"}}),t._v("  "),a("el-button",{attrs:{type:"primary",loading:t.detectLoading},on:{click:t.detect}},[t._v(" Detect ")])],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:t.addForm.title,callback:function(e){t.$set(t.addForm,"title",e)},expression:"addForm.title"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4}},model:{value:t.addForm.summary,callback:function(e){t.$set(t.addForm,"summary",e)},expression:"addForm.summary"}})],1),a("el-form-item",{attrs:{label:"图标"}},[a("upload",{model:{value:t.addForm.logo,callback:function(e){t.$set(t.addForm,"logo",e)},expression:"addForm.logo"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.addFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{loading:t.addLoading,type:"primary"},nativeOn:{click:function(e){return t.addSubmit.apply(null,arguments)}}},[t._v(" 提交 ")])],1)],1),a("el-dialog",{attrs:{visible:t.editFormVisible,"close-on-click-modal":!1,title:"编辑"},on:{"update:visible":function(e){t.editFormVisible=e}}},[a("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.editFormRules,"label-width":"80px"}},[a("el-input",{attrs:{type:"hidden"},model:{value:t.editForm.id,callback:function(e){t.$set(t.editForm,"id",e)},expression:"editForm.id"}}),a("el-form-item",{attrs:{label:"链接"}},[a("el-input",{model:{value:t.editForm.url,callback:function(e){t.$set(t.editForm,"url",e)},expression:"editForm.url"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:t.editForm.title,callback:function(e){t.$set(t.editForm,"title",e)},expression:"editForm.title"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4}},model:{value:t.editForm.summary,callback:function(e){t.$set(t.editForm,"summary",e)},expression:"editForm.summary"}})],1),a("el-form-item",{attrs:{label:"Logo"}},[a("upload",{model:{value:t.editForm.logo,callback:function(e){t.$set(t.editForm,"logo",e)},expression:"editForm.logo"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.editForm.status,callback:function(e){t.$set(t.editForm,"status",e)},expression:"editForm.status"}},[a("el-option",{key:0,attrs:{value:0,label:"正常"}}),a("el-option",{key:1,attrs:{value:1,label:"禁用"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.editFormVisible=!1}}},[t._v(" 取消 ")]),a("el-button",{attrs:{loading:t.editLoading,type:"primary"},nativeOn:{click:function(e){return t.editSubmit.apply(null,arguments)}}},[t._v(" 提交 ")])],1)],1)],1)},l=[],o=i("1da1"),r=(i("96cf"),i("d3b7"),i("a4d3"),i("e01a"),i("d443")),s={components:{Upload:r["a"]},data:function(){return{results:[],listLoading:!1,page:{},filters:{},addForm:{},addFormVisible:!1,addFormRules:{},addLoading:!1,detectLoading:!1,editForm:{},editFormVisible:!1,editFormRules:{},editLoading:!1}},mounted:function(){this.list()},methods:{list:function(){var t=this;t.listLoading=!0;var e=Object.assign(t.filters,{skipCount:this.getSkipCount(t.page.page,t.page.limit),maxResultCount:t.page.limit});this.axios.post("/api/app/friendly-link/list",e).then((function(e){t.results=e.items,t.page.total=e.totalCount})).finally((function(){t.listLoading=!1}))},handlePageChange:function(t){this.page.page=t,this.list()},handleLimitChange:function(t){this.page.limit=t,this.list()},handleAdd:function(){this.addForm={},this.addFormVisible=!0},addSubmit:function(){var t=this;this.axios.post("/api/app/friendly-link",this.addForm).then((function(e){t.$message({message:"提交成功",type:"success"}),t.addFormVisible=!1,t.list()})).catch((function(e){t.$notify.error({title:"错误",message:e.message})}))},detect:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.addForm.url){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.$confirm("确定采集吗，采集之后将覆盖现有内容?","提示",{type:"warning"});case 5:if(i=e.sent,!i){e.next=12;break}return t.detectLoading=!0,e.next=10,t.axios.post("/api/app/friendly-link/detect",{url:t.addForm.url});case 10:a=e.sent,a&&a.title&&(t.$set(t.addForm,"title",a.title),t.$set(t.addForm,"summary",a.description));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),t.$notify.error({title:"错误",message:e.t0.message||e.t0});case 17:return e.prev=17,t.detectLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))()},handleEdit:function(t,e){var i=this;this.axios.get("/api/app/friendly-link/".concat(e.id)).then((function(t){i.editForm=Object.assign({},t),i.editFormVisible=!0})).catch((function(t){i.$notify.error({title:"错误",message:t.message})}))},editSubmit:function(){var t=this;this.axios.put("/api/app/friendly-link/"+t.editForm.id,t.editForm).then((function(e){t.list(),t.editFormVisible=!1})).catch((function(e){t.$notify.error({title:"错误",message:e.message})}))},handleDel:function(t,e){var i=this,a=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.axios.delete("/api/app/friendly-link/"+e.id).then((function(t){a.$message({message:"删除成功",type:"success"}),a.list()})).catch((function(t){a.$notify.error({title:"错误",message:t.message})}))})).catch((function(){}))}}},n=s,d=(i("4ce9"),i("2877")),c=Object(d["a"])(n,a,l,!1,null,"6418283a",null);e["default"]=c.exports},d443:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"uploader",attrs:{action:t.action,"with-credentials":!1,"show-file-list":!1,headers:t.headers,accept:"image/*","before-upload":t.startLoad,"on-success":t.handleSuccess,"on-error":t.handleError}},[t.value?i("img",{staticClass:"upload-image",attrs:{src:t.value},on:{load:t.finishLoad,error:t.finishLoad}}):t._e(),i("i",{staticClass:"el-icon-plus uploader-icon",class:{show:!t.value}})])},l=[],o=i("5f87"),r={props:{value:{type:String,default:""}},data:function(){return{loading:!1}},computed:{action:function(){return"http://192.168.1.83:5128/api/file/blob-picture-save"},headers:function(){var t=Object(o["a"])();return{Authorization:"Bearer "+(t||"")}}},methods:{handleSuccess:function(t,e){this.$emit("input",t),this.$message.success("上传成功")},startLoad:function(){this.loading=!0},finishLoad:function(){this.loading=!1},handleError:function(t){var e=JSON.parse(t.message);this.$message.error(e.error.message||"上传失败"),this.loading=!1}}},s=r,n=(i("8f85"),i("2877")),d=Object(n["a"])(s,a,l,!1,null,"4d91544d",null);e["a"]=d.exports}}]);
//# sourceMappingURL=chunk-161b208a.effc19f8.js.map